# 第3回任意課題

## 質問設計の観点と意図
AWSを活用した機械学習システムの構築を想定し設問を策定した。
設問設計の意図は以下の二点である。

第一に、本講義の前提条件として「PyTorchによるモデル学習経験およびHugging Faceを用いた事前学習済みモデル活用経験」が掲げられており、
受講者には機械学習に関する基礎知識が備わっていると想定される。一方で、AWSをはじめとするIaaSの運用経験は前提とされていないため、
受講者から関連質問が多く寄せられる可能性が高いと考えた。

第二に、AWSの公式ドキュメントは網羅性および正確性に優れており、関連文献の入手が容易であることから、設問の参考資料として適切であると判断した。

## 質問セット
回答は、ChatGPT o3（検索機能ON）により生成したものを記載している。
質問6は、2025年1月以降に発生した事象であり、ナレッジカットオフ以降であるためLLM単体で答えることができない。

### 1. すでに構築したクラウド環境を IaC に変換する機能はありますか？  
**回答**  
はい。AWS CloudFormation の *Resource Import* 機能では、既存リソースをテンプレートに記述してスタックへ取り込みます 。  
Terraform でも `terraform import` コマンドを使い、状態ファイルに既存リソースを登録できます 。  
複雑なスタックでは、インポート後にパラメータや依存関係を手動でレビュー・修正するのが一般的です。

---

### 2. 大量の機械学習トレーニングデータはどこに保管すべきですか？  
**回答**  
Amazon S3 が推奨です。オブジェクトを自動で冗長化し、11 ナイン (99.999999999 %) の耐久性を提供します。
データレイクや SageMaker とネイティブ統合され、ペタバイト級でもスケールを意識せずに利用できます 。  
S3 イベントで Lambda を呼び出せば、取込直後の前処理やメタデータ登録も自動化できます 。

---

### 3. SageMaker のトレーニングジョブが S3 にアクセスするには IAM ユーザーが必要ですか？  
**回答**  
IAM ユーザーは不要です。SageMaker には **IAM 実行ロール**を付与し、そのロールに `s3:*` など必要なポリシーをアタッチします 。  
ジョブ実行時、SageMaker はこのロールを引き受けて S3 や CloudWatch などのサービス API を呼び出します 。

---

### 4. トレーニング費用を抑える方法はありますか？  
**回答**  
Amazon SageMaker **Managed Spot Training** を有効にすると、オンデマンド比で最大 90 % のコスト削減が可能です 。  
Spot 中断に備えてチェックポイントを S3 に保存する仕組みがあり、再開時に自動で引き継げます 。  
学習時間よりコスト優先のワークロードで効果が高いベストプラクティスです 。

---

### 5. Notebook Instance と SageMaker Studio はどう使い分けるべきですか？  
**回答**  
Studio Classic ノートブックは起動が Notebook Instance より 5–10 倍速く、インスタンス種別もブラウザから即変更できます 。  
Notebook Instance はシングルユーザーで完全に分離した環境が欲しい場合や、従来の CLI/SDK 手順を重視するケースに向きます 。  
いずれも従量課金ですが、Studio はアイドル状態の EFS ストレージ料金、Instance は EC2 実行料金の最小化がポイントです 。

---

### 6. BedrockでDeepSeek-R1を使った場合、どのくらいの推論コストがかかりますか？
**回答**  
1,000 入力トークンあたりの料金は0.00135 USD、1,000 出力トークンあたりの料金は0.0054 USDです。
これは、他のオープンモデル（Llama 3.3など）に対して比較的高い料金となっています。